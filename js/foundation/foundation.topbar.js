(function(e,t,n,r){"use strict";Foundation.libs.topbar={name:"topbar",version:"5.5.0",settings:{index:0,sticky_class:"sticky",custom_back_text:true,back_text:"Back",mobile_show_parent_link:true,is_hover:true,scrolltop:true,sticky_on:"all"},init:function(t,n,r){Foundation.inherit(this,"add_custom_rule register_media throttle");var i=this;i.register_media("topbar","foundation-mq-topbar");this.bindings(n,r);i.S("["+this.attr_name()+"]",this.scope).each(function(){var t=e(this),n=t.data(i.attr_name(true)+"-init"),r=i.S("section, .top-bar-section",this);t.data("index",0);var s=t.parent();if(s.hasClass("fixed")||i.is_sticky(t,s,n)){i.settings.sticky_class=n.sticky_class;i.settings.sticky_topbar=t;t.data("height",s.outerHeight());t.data("stickyoffset",s.offset().top)}else{t.data("height",t.outerHeight())}if(!n.assembled){i.assemble(t)}if(n.is_hover){i.S(".has-dropdown",t).addClass("not-click")}else{i.S(".has-dropdown",t).removeClass("not-click")}i.add_custom_rule(".f-topbar-fixed { padding-top: "+t.data("height")+"px }");if(s.hasClass("fixed")){i.S("body").addClass("f-topbar-fixed")}})},is_sticky:function(e,t,n){var r=t.hasClass(n.sticky_class);if(r&&n.sticky_on==="all"){return true}else if(r&&this.small()&&n.sticky_on==="small"){return matchMedia(Foundation.media_queries.small).matches&&!matchMedia(Foundation.media_queries.medium).matches&&!matchMedia(Foundation.media_queries.large).matches}else if(r&&this.medium()&&n.sticky_on==="medium"){return matchMedia(Foundation.media_queries.small).matches&&matchMedia(Foundation.media_queries.medium).matches&&!matchMedia(Foundation.media_queries.large).matches}else if(r&&this.large()&&n.sticky_on==="large"){return matchMedia(Foundation.media_queries.small).matches&&matchMedia(Foundation.media_queries.medium).matches&&matchMedia(Foundation.media_queries.large).matches}return false},toggle:function(n){var r=this,i;if(n){i=r.S(n).closest("["+this.attr_name()+"]")}else{i=r.S("["+this.attr_name()+"]")}var s=i.data(this.attr_name(true)+"-init");var o=r.S("section, .top-bar-section",i);if(r.breakpoint()){if(!r.rtl){o.css({left:"0%"});e(">.name",o).css({left:"100%"})}else{o.css({right:"0%"});e(">.name",o).css({right:"100%"})}r.S("li.moved",o).removeClass("moved");i.data("index",0);i.toggleClass("expanded").css("height","")}if(s.scrolltop){if(!i.hasClass("expanded")){if(i.hasClass("fixed")){i.parent().addClass("fixed");i.removeClass("fixed");r.S("body").addClass("f-topbar-fixed")}}else if(i.parent().hasClass("fixed")){if(s.scrolltop){i.parent().removeClass("fixed");i.addClass("fixed");r.S("body").removeClass("f-topbar-fixed");t.scrollTo(0,0)}else{i.parent().removeClass("expanded")}}}else{if(r.is_sticky(i,i.parent(),s)){i.parent().addClass("fixed")}if(i.parent().hasClass("fixed")){if(!i.hasClass("expanded")){i.removeClass("fixed");i.parent().removeClass("expanded");r.update_sticky_positioning()}else{i.addClass("fixed");i.parent().addClass("expanded");r.S("body").addClass("f-topbar-fixed")}}}},timer:null,events:function(n){var r=this,i=this.S;i(this.scope).off(".topbar").on("click.fndtn.topbar","["+this.attr_name()+"] .toggle-topbar",function(e){e.preventDefault();r.toggle(this)}).on("click.fndtn.topbar",'.top-bar .top-bar-section li a[href^="#"],['+this.attr_name()+'] .top-bar-section li a[href^="#"]',function(t){var n=e(this).closest("li");if(r.breakpoint()&&!n.hasClass("back")&&!n.hasClass("has-dropdown")){r.toggle()}}).on("click.fndtn.topbar","["+this.attr_name()+"] li.has-dropdown",function(t){var n=i(this),s=i(t.target),o=n.closest("["+r.attr_name()+"]"),u=o.data(r.attr_name(true)+"-init");if(s.data("revealId")){r.toggle();return}if(r.breakpoint())return;if(u.is_hover&&!Modernizr.touch)return;t.stopImmediatePropagation();if(n.hasClass("hover")){n.removeClass("hover").find("li").removeClass("hover");n.parents("li.hover").removeClass("hover")}else{n.addClass("hover");e(n).siblings().removeClass("hover");if(s[0].nodeName==="A"&&s.parent().hasClass("has-dropdown")){t.preventDefault()}}}).on("click.fndtn.topbar","["+this.attr_name()+"] .has-dropdown>a",function(e){if(r.breakpoint()){e.preventDefault();var t=i(this),n=t.closest("["+r.attr_name()+"]"),s=n.find("section, .top-bar-section"),o=t.next(".dropdown").outerHeight(),u=t.closest("li");n.data("index",n.data("index")+1);u.addClass("moved");if(!r.rtl){s.css({left:-(100*n.data("index"))+"%"});s.find(">.name").css({left:100*n.data("index")+"%"})}else{s.css({right:-(100*n.data("index"))+"%"});s.find(">.name").css({right:100*n.data("index")+"%"})}n.css("height",t.siblings("ul").outerHeight(true)+n.data("height"))}});i(t).off(".topbar").on("resize.fndtn.topbar",r.throttle(function(){r.resize.call(r)},50)).trigger("resize").trigger("resize.fndtn.topbar").load(function(){i(this).trigger("resize.fndtn.topbar")});i("body").off(".topbar").on("click.fndtn.topbar",function(e){var t=i(e.target).closest("li").closest("li.hover");if(t.length>0){return}i("["+r.attr_name()+"] li.hover").removeClass("hover")});i(this.scope).on("click.fndtn.topbar","["+this.attr_name()+"] .has-dropdown .back",function(e){e.preventDefault();var t=i(this),n=t.closest("["+r.attr_name()+"]"),s=n.find("section, .top-bar-section"),o=n.data(r.attr_name(true)+"-init"),u=t.closest("li.moved"),a=u.parent();n.data("index",n.data("index")-1);if(!r.rtl){s.css({left:-(100*n.data("index"))+"%"});s.find(">.name").css({left:100*n.data("index")+"%"})}else{s.css({right:-(100*n.data("index"))+"%"});s.find(">.name").css({right:100*n.data("index")+"%"})}if(n.data("index")===0){n.css("height","")}else{n.css("height",a.outerHeight(true)+n.data("height"))}setTimeout(function(){u.removeClass("moved")},300)});i(this.scope).find(".dropdown a").focus(function(){e(this).parents(".has-dropdown").addClass("hover")}).blur(function(){e(this).parents(".has-dropdown").removeClass("hover")})},resize:function(){var e=this;e.S("["+this.attr_name()+"]").each(function(){var t=e.S(this),r=t.data(e.attr_name(true)+"-init");var i=t.parent("."+e.settings.sticky_class);var s;if(!e.breakpoint()){var o=t.hasClass("expanded");t.css("height","").removeClass("expanded").find("li").removeClass("hover");if(o){e.toggle(t)}}if(e.is_sticky(t,i,r)){if(i.hasClass("fixed")){i.removeClass("fixed");s=i.offset().top;if(e.S(n.body).hasClass("f-topbar-fixed")){s-=t.data("height")}t.data("stickyoffset",s);i.addClass("fixed")}else{s=i.offset().top;t.data("stickyoffset",s)}}})},breakpoint:function(){return!matchMedia(Foundation.media_queries["topbar"]).matches},small:function(){return matchMedia(Foundation.media_queries["small"]).matches},medium:function(){return matchMedia(Foundation.media_queries["medium"]).matches},large:function(){return matchMedia(Foundation.media_queries["large"]).matches},assemble:function(t){var n=this,r=t.data(this.attr_name(true)+"-init"),i=n.S("section, .top-bar-section",t);i.detach();n.S(".has-dropdown>a",i).each(function(){var t=n.S(this),i=t.siblings(".dropdown"),s=t.attr("href"),o;if(!i.find(".title.back").length){if(r.mobile_show_parent_link==true&&s){o=e('<li class="title back js-generated"><h5><a href="javascript:void(0)"></a></h5></li><li class="parent-link show-for-small-only"><a class="parent-link js-generated" href="'+s+'">'+t.html()+"</a></li>")}else{o=e('<li class="title back js-generated"><h5><a href="javascript:void(0)"></a></h5>')}if(r.custom_back_text==true){e("h5>a",o).html(r.back_text)}else{e("h5>a",o).html("&laquo; "+t.html())}i.prepend(o)}});i.appendTo(t);this.sticky();this.assembled(t)},assembled:function(t){t.data(this.attr_name(true),e.extend({},t.data(this.attr_name(true)),{assembled:true}))},height:function(t){var n=0,r=this;e("> li",t).each(function(){n+=r.S(this).outerHeight(true)});return n},sticky:function(){var e=this;this.S(t).on("scroll",function(){e.update_sticky_positioning()})},update_sticky_positioning:function(){var e="."+this.settings.sticky_class,n=this.S(t),r=this;if(r.settings.sticky_topbar&&r.is_sticky(this.settings.sticky_topbar,this.settings.sticky_topbar.parent(),this.settings)){var i=this.settings.sticky_topbar.data("stickyoffset");if(!r.S(e).hasClass("expanded")){if(n.scrollTop()>i){if(!r.S(e).hasClass("fixed")){r.S(e).addClass("fixed");r.S("body").addClass("f-topbar-fixed")}}else if(n.scrollTop()<=i){if(r.S(e).hasClass("fixed")){r.S(e).removeClass("fixed");r.S("body").removeClass("f-topbar-fixed")}}}}},off:function(){this.S(this.scope).off(".fndtn.topbar");this.S(t).off(".fndtn.topbar")},reflow:function(){}}})(jQuery,window,window.document)
